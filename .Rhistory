citation()
require(R2jags)
require(readr)
require(tidyr)
require(dplyr)
################################################################################
#  Set working directory
setwd("~/Leah_frogs")
#  Source helper functions
source("~/Leah_frogs/helpers/Nmix_utility_funs.R")
#  Workflow for Nmix models
#  Josh Nowak and Leah Swartz
#  02/2017
################################################################################
#  Packages
require(R2jags)
require(readr)
require(tidyr)
require(dplyr)
################################################################################
#  Set working directory
setwd("~/Leah_frogs")
#  Source helper functions
source("~/Leah_frogs/helpers/Nmix_utility_funs.R")
#  Load observation data
raw_dat <- read_csv("~/Blackrock/Data/TadpolePaper/2015AND2016TrappingData.csv")
load("data/site_dic.RData")
cov_dat <- read.csv("~/Blackrock/Data/Invert Paper/BR_site_covariates.csv") %>%
mutate(
site = site_dic$site_num[match(SiteName, site_dic$site_nm)]
)%>%
filter(site!="NA")%>%
mutate(type=as.numeric(WetlandType))
y_obs <- morph_data(raw_dat, site_dic) %>%
left_join( .,cov_dat, by="site") %>%
mutate(created=if_else(type=="1",1,0)) %>%
mutate(impacted=if_else(type=="2",1,0))%>%
mutate(reference=if_else(type=="3",1,0))
fit4 <- y_obs %>%
group_by(sp, year) %>%
do(fit =
try(call_jags(
x = .,
covs = "n_trap","impacted","created",
model.file = "models/Nmix_sNtN_trapD.txt",
n.chains = 3,
n.iter = 500,
n.burnin = 100,
n.thin = 1
))
)
fit3 <- y_obs %>%
group_by(sp, year) %>%
do(fit =
try(call_jags(
x = .,
covs = "n_trap",
model.file = "models/Nmix_sN_trapD.txt",
n.chains = 3,
n.iter = 500,
n.burnin = 100,
n.thin = 1
))
)
fit3$fit
